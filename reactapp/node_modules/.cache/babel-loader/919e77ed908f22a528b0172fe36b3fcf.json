{"ast":null,"code":"import _createForOfIteratorHelper from\"/Users/smr/Desktop/population_demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createForOfIteratorHelper\";import _regeneratorRuntime from\"/Users/smr/Desktop/population_demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/smr/Desktop/population_demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/smr/Desktop/population_demo/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useEffect,useState}from'react';import'./styles/App.css';import logo from'./img/taipei-city-logo.png';import BarChart from'./component/BarChart';import{API_HOST}from'./config';import axios from'axios';import Spinner from'./component/Spinner';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";import{Fragment as _Fragment}from\"react/jsx-runtime\";function App(){var _useState=useState([{}]),_useState2=_slicedToArray(_useState,2),districtOpt=_useState2[0],setDistrictOpt=_useState2[1];var _useState3=useState(true),_useState4=_slicedToArray(_useState3,2),isLoading=_useState4[0],setIsLoading=_useState4[1];var _useState5=useState({labels:[\"共同生活戶\",\"單獨生活戶\"],datasets:[{label:'女性',data:[0,0],backgroundColor:\"#DF7B7B\"},{label:'男性',data:[0,0],backgroundColor:\"#478CD1\"}]}),_useState6=_slicedToArray(_useState5,2),dataSet=_useState6[0],setDataSet=_useState6[1];useEffect(function(){_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var rawdata,tpeDistData,r,set,result;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get(\"\".concat(API_HOST));case 2:rawdata=_context.sent;//  console.log(rawdata.data)\ntpeDistData=rawdata.data;r=tpeDistData.filter(function(v){return v.site_id.slice(0,3)===\"臺北市\";});// console.log(r)\nset=new Set();result=r.filter(function(v){return!set.has(v.site_id)?set.add(v.site_id):false;});setDistrictOpt(result);case 8:case\"end\":return _context.stop();}}},_callee);}))();setTimeout(function(){setIsLoading(false);},8000);},[]);var loadDistrictData=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(e){var dist,fosum,mosum,fssum,mssum,rawData,allTpeDistData,j,_iterator,_step,i;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:dist=document.getElementById('tpedist');fosum=0;mosum=0;fssum=0;mssum=0;if(!(dist.value===e.target.value)){_context2.next=13;break;}_context2.next=8;return axios.get(\"\".concat(API_HOST));case 8:rawData=_context2.sent;allTpeDistData=rawData.data;j=allTpeDistData.filter(function(v){return v.site_id===e.target.value;});_iterator=_createForOfIteratorHelper(j);try{for(_iterator.s();!(_step=_iterator.n()).done;){i=_step.value;fosum+=i.household_ordinary_f-0;mosum+=i.household_ordinary_m-0;fssum+=i.household_single_f-0;mssum+=i.household_single_m-0;}}catch(err){_iterator.e(err);}finally{_iterator.f();}case 13:setDataSet({labels:[\"共同生活戶\",\"單獨生活戶\"],datasets:[{label:'女性',data:[fosum,fssum],backgroundColor:\"#DF7B7B\"},{label:'男性',data:[mosum,mssum],backgroundColor:\"#478CD1\"}]});case 14:case\"end\":return _context2.stop();}}},_callee2);}));return function loadDistrictData(_x){return _ref2.apply(this,arguments);};}();var setDataBack=function setDataBack(){setDataSet({labels:[\"共同生活戶\",\"單獨生活戶\"],datasets:[{label:'女性',data:[0,0],backgroundColor:\"#DF7B7B\"},{label:'男性',data:[0,0],backgroundColor:\"#478CD1\"}]});};return/*#__PURE__*/_jsx(_Fragment,{children:/*#__PURE__*/_jsxs(\"div\",{className:\"container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"tpgov_logo mb-3 mt-4 mx-auto\",children:/*#__PURE__*/_jsx(\"img\",{src:logo,alt:\"\"})}),/*#__PURE__*/_jsx(\"p\",{className:\"title mb-5\",children:\"108\\u5E74\\u53F0\\u5317\\u5E02\\u5404\\u5340\\u6236\\u6578\\u8CC7\\u6599\"}),/*#__PURE__*/_jsxs(\"div\",{className:isLoading?'mySpinner d-flex':'mySpinner d-none',children:[/*#__PURE__*/_jsx(Spinner,{}),\"\\u8CC7\\u6599\\u8F09\\u5165\\u4E2D\\uFF0C\\u8ACB\\u7A0D\\u5019\"]}),/*#__PURE__*/_jsxs(\"div\",{className:isLoading?'d-flex align-center justify-content-evenly mb-3 opacity0':'d-flex align-center mb-3 opacity1',children:[/*#__PURE__*/_jsx(\"div\",{className:\"district\"}),/*#__PURE__*/_jsx(\"p\",{className:\"test\",children:\"\\u884C\\u653F\\u5340\"}),/*#__PURE__*/_jsx(\"div\",{className:\"space\"}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsxs(\"select\",{name:\"\",id:\"tpedist\",onChange:function onChange(e){loadDistrictData(e);},onClick:function onClick(){setDataBack();},children:[/*#__PURE__*/_jsx(\"option\",{children:\"\\u8ACB\\u9078\\u64C7\"}),districtOpt.length!==0?districtOpt.map(function(district,key){return/*#__PURE__*/_jsx(\"option\",{children:district.site_id},key);}):/*#__PURE__*/_jsx(_Fragment,{})]})})]}),/*#__PURE__*/_jsx(\"div\",{className:\"row\",children:/*#__PURE__*/_jsx(BarChart,{dataSet:dataSet})})]})});}export default App;","map":{"version":3,"sources":["/Users/smr/Desktop/population_demo/src/App.js"],"names":["React","useEffect","useState","logo","BarChart","API_HOST","axios","Spinner","App","districtOpt","setDistrictOpt","isLoading","setIsLoading","labels","datasets","label","data","backgroundColor","dataSet","setDataSet","get","rawdata","tpeDistData","r","filter","v","site_id","slice","set","Set","result","has","add","setTimeout","loadDistrictData","e","dist","document","getElementById","fosum","mosum","fssum","mssum","value","target","rawData","allTpeDistData","j","i","household_ordinary_f","household_ordinary_m","household_single_f","household_single_m","setDataBack","length","map","district","key"],"mappings":"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","sourcesContent":["import React, {\n  useEffect,useState\n \n} from 'react'\nimport './styles/App.css';\nimport logo from './img/taipei-city-logo.png'\nimport BarChart from './component/BarChart'\nimport {\n  API_HOST\n} from './config'\nimport axios from 'axios'\nimport Spinner from './component/Spinner'\nfunction App() {\n  const [districtOpt, setDistrictOpt] = useState([{}]);\n  const [isLoading, setIsLoading] = useState(true);\n  const [dataSet, setDataSet] = useState({\n    labels: [\"共同生活戶\", \"單獨生活戶\"],\n    datasets: [{\n        label: '女性',\n        data: [0,0],\n        backgroundColor: \"#DF7B7B\",\n      },\n      {\n        label: '男性',\n        data: [0, 0],\n        backgroundColor: \"#478CD1\",\n      },\n    ],\n  });\n  useEffect(()=>{\n   (async () => {\n     let rawdata = await axios.get(`${API_HOST}`)\n    //  console.log(rawdata.data)\n    const tpeDistData = rawdata.data\n     let r = tpeDistData.filter((v) => {\n       return v.site_id.slice(0, 3) === \"臺北市\";\n    })\n    // console.log(r)\n    let set = new Set();\n    const result = r.filter(v => {\n      return !set.has(v.site_id) ? set.add(v.site_id) : false\n    })\n    setDistrictOpt(result)\n    \n     })()\n     setTimeout(() => {\n       setIsLoading(false)\n     }, 8000)\n  },[])\n  \n\n const loadDistrictData=async(e)=>{\n const dist = document.getElementById('tpedist');\n let fosum = 0;\n let mosum = 0;\n let fssum = 0;\n let mssum = 0;\n if(dist.value === e.target.value){\n        let rawData = await axios.get(`${API_HOST}`)\n        const allTpeDistData = rawData.data\n        const j = allTpeDistData.filter((v) => {\n        return v.site_id === e.target.value;\n        })\n      \n        for (let i of j) {    \n          fosum += (i.household_ordinary_f - 0);\n          mosum += (i.household_ordinary_m - 0);\n          fssum += (i.household_single_f - 0);\n          mssum += (i.household_single_m - 0);\n        }            \n }\n setDataSet({\n   labels: [\"共同生活戶\", \"單獨生活戶\"],\n   datasets: [{\n       label: '女性',\n       data: [fosum, fssum],\n       backgroundColor: \"#DF7B7B\",\n     },\n     {\n       label: '男性',\n       data: [mosum, mssum],\n       backgroundColor: \"#478CD1\",\n     },\n   ],\n })\n  \n }\n \n const setDataBack = ()=>{\n   setDataSet({\n     labels: [\"共同生活戶\", \"單獨生活戶\"],\n     datasets: [{\n         label: '女性',\n         data: [0, 0],\n         backgroundColor: \"#DF7B7B\",\n       },\n       {\n         label: '男性',\n         data: [0, 0],\n         backgroundColor: \"#478CD1\",\n       },\n     ],\n   })\n\n }\n\nreturn (\n    <>\n\n      <div className=\"container\">\n      \n   <div className=\"tpgov_logo mb-3 mt-4 mx-auto\">\n   <img src={logo} alt=\"\"></img>\n  </div> \n  <p className=\"title mb-5\">108年台北市各區戶數資料</p>\n  \n <div className={isLoading? 'mySpinner d-flex' : 'mySpinner d-none'}><Spinner />資料載入中，請稍候</div>\n  <div className={\n    isLoading ? 'd-flex align-center justify-content-evenly mb-3 opacity0' : 'd-flex align-center mb-3 opacity1'\n  }\n  >\n <div className=\"district\"></div>\n    <p className=\"test\">\n      行政區\n    </p>\n     <div className=\"space\"></div>\n    <div>\n      <select name = \"\"\n      id = \"tpedist\"\n      onChange = {\n        (e)=>{loadDistrictData(e)\n       }\n      }\n      onClick={()=>{setDataBack()}}>\n        <option>請選擇</option>\n   {  \n   districtOpt.length !== 0 ? (districtOpt.map((district,key)=>{\n       return(\n           <option key={key}>{district.site_id}</option>\n       )\n     })):(<></>)    \n   }\n      </select>\n    </div>\n  </div>\n <div className=\"row\">\n   <BarChart\n     dataSet = {\n       dataSet\n     }\n   />\n </div>\n</div>\n    </>\n  );\n\n  }\nexport default App\n"]},"metadata":{},"sourceType":"module"}